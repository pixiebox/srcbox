!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof exports?module.exports=b:a.srcBox=b(a)}(this,function(a){Object.size=function(a){var b,c=0;for(b in a)a.hasOwnProperty(b)&&c++;return c};var b={breakpoint:0,breakpointVal:0,currentBreakpoint:0,lazyElems:[],mergedElements:[],selector:{},viewPortWidth:0,addEvent:function(a,b,c){b.addEventListener?b.addEventListener(a,c,!1):b.attachEvent?b.attachEvent("on"+a,c):b[a]=c},debounce:function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}},devicePixelRatio:function(){return"devicePixelRatio"in window?window.devicePixelRatio:1},extend:function(a,c){var d={};return b.forEach(a,function(b,c){d[c]=a[c]}),b.forEach(c,function(a,b){d[b]=c[b]}),d},forEach:function(a,b,c){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.call(c,a[d],d,a);else for(var e=0,f=a.length;f>e;e++)b.call(c,a[e],e,a)},getBreakpoint:function(a,c){for(var d,e,f,g,h,i=c,j=0,k={};d=a[j];)g=d.minWidth,e=d.maxWidth,f="minDevicePixelRatio"in d?d.minDevicePixelRatio:0,h="hide"in d,c>0?(g&&e&&c>=g&&e>=c||g&&!e&&c>=g||e&&!g&&e>=c)&&(!f||f&&b.devicePixelRatio()>=f)&&(k=d,e&&h&&(k.folder="hide")):(0>=i||i>g||i>e)&&(i=g||e||i,k=d),j++;return k},getViewport:function(){var a=window,b="inner";return"innerWidth"in window||(b="client",a=document.documentElement||document.body),{width:a[b+"Width"],height:a[b+"Height"]}},inviewport:function(a){var b=a.getBoundingClientRect(),c=document.documentElement;return b.top>=0&&b.left>=0&&b.bottom<=(window.innerHeight||c.clientHeight)&&b.right<=(window.innerWidth||c.clientWidth)},isEmpty:function(a){for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},orientationEvent:function(){return b.supportsOrientationChange()?"orientationchange":"resize"},removeClass:function(a,b){var c,d="",e=a.className.split(" ");for(c=0;c<e.length;c++)e[c]!==b&&(d+=e[c]+" ");a.className=d},removeEvent:function(a,b,c){b.removeEventListener?b.removeEventListener(a,c,!1):b.detachEvent?b.detachEvent("on"+a,c):b.splice(a,1)},setBreakpoint:function(a,c){if("hide"==c)return a.className=a.className+" srcbox-hidden",void("img"!=a.nodeName.toLowerCase()&&(a.style.backgroundImage="",a.style.backgroundRepeat=""));a.className.indexOf("srcbox-hidden")>=0&&(a.className=a.className.replace(/(?:^|\s)srcbox-hidden(?!\S)/g,""));var d,e=a.getAttribute("data-breakpoint"),f=a.getAttribute("data-img");if(!e||!f)throw new Error('srcBox.js [function setBreakpoint]: The provided elements are missing a data-breakpoint or data-img attribute: <img data-breakpoint="/path/to/folder/{breakpoint}" data-img="some-img.jpg" />');d=(e+f).replace("{folder}",c),b.setSrc(a,d)},setImage:function(a,c){var d,e=a.getAttribute("data-breakpointwidth")||(c.parentOffset?a.parentNode.offsetWidth:b.getViewport().width),f=b.getBreakpoint(c.breakpoints,e);d=b.isEmpty(f)?d=c.defaultBreakpoint.folder:f.folder,b.setBreakpoint(a,d)},setImages:function(a,d){viewPortWidth=b.getViewport().width,breakpoint=b.getBreakpoint(c.settings[d].breakpoints,viewPortWidth),breakpointVal=b.isEmpty(breakpoint)?c.settings[d].defaultBreakpoint.folder:breakpoint.maxWidth||breakpoint.minWidth,b.currentBreakpoint!=breakpointVal&&(d==b.selector[Object.size(b.selector)-1]&&(b.currentBreakpoint=breakpointVal),b.forEach(a,function(e,f){b.setImage(a[f],c.settings[d])}),b.addEvent("scroll",window,b.setLazySrc))},setLazySrc:function(){for(var a=b.lazyElems.length;a--;)b.inviewport(b.lazyElems[a])&&(b.lazyElems[a].src=b.lazyElems[a].getAttribute("data-lag-src"),b.lazyElems[a].removeAttribute("height"),b.lazyElems.splice(a,1))},setSrc:function(a,c){new RegExp("(^|\\s)lag(\\s|$)").test(a.className)?(a.setAttribute("data-lag-src",c),b.lazyElems.push(a)):"img"===a.nodeName.toLowerCase()?(a.src=c,a.removeAttribute("height")):a.style.backgroundImage="url("+c+")"},supportsOrientationChange:function(){return"ontouchstart"in window}},c={settings:[],init:function(a,d,e){if(b.currentBreakpoint=0,document.all&&!document.addEventListener){var f=Array.prototype.slice;Array.prototype.slice=function(){if(this instanceof Array)return f.apply(this,arguments);for(var a=[],b=arguments.length>=1?arguments[0]:0,c=arguments.length>=2?arguments[1]:this.length,d=b;c>d;d++)a.push(this[d]);return a}}var g,e=e||document,d=d||[],h=Array.prototype.slice.call(e.querySelectorAll(a))||[],i={breakpoints:[{folder:"480",maxWidth:480},{folder:"640",minWidth:481,maxWidth:767},{folder:"900",minWidth:768,maxWidth:900},{folder:"1170",minWidth:992},{folder:"900",minWidth:748,maxWidth:1024},{folder:"640",maxWidth:320,minDevicePixelRatio:2},{folder:"900",minWidth:320,maxWidth:667,minDevicePixelRatio:2},{folder:"2048",minWidth:414,maxWidth:736,minDevicePixelRatio:3},{folder:"2048",minWidth:748,maxWidth:1024,minDevicePixelRatio:2}],debug:!1,parentOffset:!0},j="object"==typeof d&&"breakpoints"in d?"extend"in d&&d.extend===!0?b.extend(i,d):d:b.extend(i,d),k=function(){g--,g||c.settings[a].onComplete()};j.defaultBreakpoint="defaultBreakpoint"in d?d.defaultBreakpoint:{folder:"1170"},c.settings[a]=j,b.selector[Object.size(b.selector)]=a,b.mergedElements[a]=h,b.setImages(h,a),b.setLazySrc(),b.lazyElems.length&&b.addEvent("scroll",window,b.setLazySrc),c.settings[a].debug&&b.addEvent(b.orientationEvent(),window,b.debounce(function(){b.forEach(b.selector,function(a,c){b.setImages(b.mergedElements[b.selector[c]],b.selector[c])})},250)),"onComplete"in c.settings[a]&&(g=h.length,g&&b.forEach(h,function(d,e){if(new RegExp("[ws]*(lag)+[ws]*").test(h[e].className))g--,g||c.settings[a].onComplete();else if(h[e].onload=k,"complete"==h[e].readyState)h[e].onload();else if(h[e].readyState)h[e].src=h[e].src;else if(h[e].complete)h[e].onload();else if(void 0===h[e].complete){var f=h[e].src;h[e].src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",h[e].src=f}b.setImage(h[e],c.settings[a])}))},reset:function(a){b.currentBreakpoint=0;var d=b.mergedElements[a];b.forEach(b.mergedElements[a],function(c,d){b.removeClass(b.mergedElements[a][d],a.substring(1))}),c.init(a,c.settings[a]),b.forEach(d,function(b,c){d[c].className+=a.substring(1)})}};return c});