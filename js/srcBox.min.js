;(function(m,a){"function"===typeof define&&define.amd?define(a):"object"===typeof exports?module.exports=a:m.srcBox=a(m)})(this,function(m){var a={mergedElements:[],selector:"",devicePixelRatio:function(){return"devicePixelRatio"in window?window.devicePixelRatio:1},lazyElems:[],breakpoint:0,currentBreakpoint:0,breakpointVal:0,viewPortWidth:0,forEach:function(b,a,d){if("[object Object]"===Object.prototype.toString.call(b))for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&a.call(d,b[c],c,b);
else{c=0;for(var f=b.length;c<f;c++)a.call(d,b[c],c,b)}},extend:function(b,e){var d={};a.forEach(b,function(a,e){d[e]=b[e]});a.forEach(e,function(b,a){d[a]=e[a]});return d},getViewportWidthInCssPixels:function(){for(var b=Math,a=[window.innerWidth,window.document.documentElement.clientWidth,window.document.documentElement.offsetWidth,window.document.body.clientWidth],d=0,c,f=window.screen.width;d<a.length;d++)isNaN(a[d])&&(a.splice(d,1),d--);a.length&&(c=b.max.apply(b,a),isNaN(f)||(c=b.min(f,c)));
return c||f||0},getBreakpoint:function(b,e){for(var d=e,c=0,f={},g,h,l,k;g=b[c];){k=g.minWidth;h=g.maxWidth;l="minDevicePixelRatio"in g?g.minDevicePixelRatio:0;if(0<e){if(k&&h&&e>=k&&e<=h||k&&!h&&e>=k||h&&!k&&e<=h)if(!l||l&&a.devicePixelRatio()>=l)f=g}else if(0>=d||k<d||h<d)d=k||h||d,f=g;c++}return f},setBreakpoint:function(b,e){var d=b.getAttribute("data-breakpoint"),c=b.getAttribute("data-img");if(!d||!c)throw Error('srcBox.js [function setBreakpoint]: The provided elements are missing a data-breakpoint or data-img attribute: <img data-breakpoint="/path/to/folder/{breakpoint}" data-img="some-img.jpg" />');
d=d.replace("{folder}",e)+b.getAttribute("data-img");/(^|\s)lag(\s|$)/.test(b.className)?(b.setAttribute("data-lag-src",d),a.lazyElems.push(b)):(b.src=d,b.removeAttribute("height"))},addEvent:function(b,a,d){a.addEventListener?a.addEventListener(b,d,!1):a.attachEvent?a.attachEvent("on"+b,d):a[b]=d},removeEvent:function(a,e,d){e.removeEventListener?e.removeEventListener(a,d,!1):e.detachEvent?e.detachEvent("on"+a,d):e.splice(a,1)},removeClass:function(a,e){var d="",c,f=a.className.split(" ");for(c=
0;c<f.length;c++)f[c]!==e&&(d+=f[c]+" ");a.className=d},scrollPos:function(){return[void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft]},offset:function(a,e){a=a.getBoundingClientRect();switch(e){case "left":return a.left;case "top":return a.top;default:return 0}},belowthefold:function(b){return(window.innerHeight?
window.innerHeight:Math.max(document.documentElement.clientHeight,document.body.clientHeight))+a.scrollPos()[0]<=a.offset(b,"top")},rightoffold:function(b){return(window.innerWidth?window.innerWidth:Math.max(document.documentElement.clientWidth,document.body.clientWidth))+a.scrollPos()[1]<=a.offset(b,"left")},abovethetop:function(b){return a.scrollPos()[0]>=a.offset(b,"top")+b.height},leftofbegin:function(b){return a.scrollPos()[1]>=a.offset(b,"left")+b.width},inviewport:function(b){return!a.rightoffold(b)&&
!a.leftofbegin(b)&&!a.belowthefold(b)&&!a.abovethetop(b)},setLazySrc:function(){for(var b=a.lazyElems.length;b--;)a.inviewport(a.lazyElems[b])&&(a.lazyElems[b].src=a.lazyElems[b].getAttribute("data-lag-src"),a.lazyElems[b].removeAttribute("height"),a.lazyElems.splice(b,1));a.lazyElems.length||a.removeEvent("scroll",window,a.setLazySrc)},debounce:function(a,e,d){var c;return function(){var f=this,g=arguments,h=d&&!c;clearTimeout(c);c=setTimeout(function(){c=null;d||a.apply(f,g)},e);h&&a.apply(f,g)}},
setImage:function(b,e){if("IMG"===b.nodeName){var d=a.getBreakpoint(e.breakpoints,b.parentNode.offsetWidth).folder;a.setBreakpoint(b,d)}},setImages:function(b,e){viewPortWidth=a.getViewportWidthInCssPixels();breakpoint=a.getBreakpoint(e.breakpoints,viewPortWidth);breakpointVal=breakpoint.maxWidth||breakpoint.minWidth;a.currentBreakpoint!=breakpointVal&&(a.currentBreakpoint=breakpointVal,a.forEach(b,function(d,c){a.setImage(b[c],e)}),a.addEvent("scroll",window,a.setLazySrc))},supportsOrientationChange:function(){return"ontouchstart"in
window},orientationEvent:function(){return supportsOrientationChange?"orientationchange":"resize"}},n={init:function(b,e){if(document.all&&!document.addEventListener){var d=Array.prototype.slice;Array.prototype.slice=function(){if(this instanceof Array)return d.apply(this,arguments);for(var a=[],b=2<=arguments.length?arguments[1]:this.length,c=1<=arguments.length?arguments[0]:0;c<b;c++)a.push(this[c]);return a}}var c=Array.prototype.slice.call(document.querySelectorAll(b)),f={breakpoints:[{folder:"480",
maxWidth:480},{folder:"640",minWidth:481,maxWidth:767},{folder:"900",minWidth:768,maxWidth:900},{folder:"1170",minWidth:992},{folder:"900",minWidth:748,maxWidth:1024},{folder:"640",maxWidth:320,minDevicePixelRatio:2},{folder:"900",minWidth:320,maxWidth:667,minDevicePixelRatio:2},{folder:"2048",minWidth:414,maxWidth:736,minDevicePixelRatio:3},{folder:"2048",minWidth:748,maxWidth:1024,minDevicePixelRatio:2}]},g="object"===typeof e&&"breakpoints"in e?"extend"in e&&!0===e.extend?a.extend(f,e):e:a.extend(f,
e),h,l=function(){h--;if(!h)g.onComplete()};a.selector=b;a.mergedElements=a.mergedElements.concat(c);a.setImages(c,g);a.setLazySrc();a.addEvent("scroll",window,a.setLazySrc);a.addEvent(a.orientationEvent,window,a.debounce(function(){a.setImages(a.mergedElements,g)},250));"onComplete"in g&&(h=c.length)&&a.forEach(c,function(b,d){a.setImage(c[d],g);if(/[ws]*(lag)+[ws]*/.test(c[d].className)){if(h--,!h)g.onComplete()}else if(c[d].onload=l,"complete"==c[d].readyState)c[d].onload();else if(c[d].readyState)c[d].src=
c[d].src;else if(c[d].complete)c[d].onload();else if(void 0===c[d].complete){var e=c[d].src;c[d].src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";c[d].src=e}})},reset:function(b){a.currentBreakpoint=0;var e=a.mergedElements;a.forEach(a.mergedElements,function(b,c){a.removeClass(a.mergedElements[c],a.selector.substring(1))});n.init(a.selector,b);a.forEach(e,function(b,c){e[c].className+=a.selector.substring(1)})}};return n});