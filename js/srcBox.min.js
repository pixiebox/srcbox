;(function(m,a){"function"===typeof define&&define.amd?define(a):"object"===typeof exports?module.exports=a:m.srcBox=a(m)})(this,function(m){Object.size=function(b){var a=0,e;for(e in b)b.hasOwnProperty(e)&&a++;return a};var a={breakpoint:0,breakpointVal:0,currentBreakpoint:0,lazyElems:[],mergedElements:[],selector:{},viewPortWidth:0,abovethetop:function(b){return a.scrollPos()[0]>=a.offset(b,"top")+b.height},addEvent:function(b,a,e){a.addEventListener?a.addEventListener(b,e,!1):a.attachEvent?a.attachEvent("on"+
b,e):a[b]=e},belowthefold:function(b){return(window.innerHeight?window.innerHeight:Math.max(document.documentElement.clientHeight,document.body.clientHeight))+a.scrollPos()[0]<=a.offset(b,"top")},debounce:function(b,a,e){var c;return function(){var f=this,g=arguments,k=e&&!c;clearTimeout(c);c=setTimeout(function(){c=null;e||b.apply(f,g)},a);k&&b.apply(f,g)}},devicePixelRatio:function(){return"devicePixelRatio"in window?window.devicePixelRatio:1},extend:function(b,d){var e={};a.forEach(b,function(a,
d){e[d]=b[d]});a.forEach(d,function(b,a){e[a]=d[a]});return e},forEach:function(b,a,e){if("[object Object]"===Object.prototype.toString.call(b))for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&a.call(e,b[c],c,b);else{c=0;for(var f=b.length;c<f;c++)a.call(e,b[c],c,b)}},getBreakpoint:function(b,d){for(var e=d,c=0,f={},g,k,h,l,n;g=b[c];){l=g.minWidth;k=g.maxWidth;h="minDevicePixelRatio"in g?g.minDevicePixelRatio:0;n="hide"in g;if(0<d){if(l&&k&&d>=l&&d<=k||l&&!k&&d>=l||k&&!l&&d<=k)if(!h||h&&
a.devicePixelRatio()>=h)f=g,k&&n&&(f.folder="hide")}else if(0>=e||l<e||k<e)e=l||k||e,f=g;c++}return f},getViewportWidthInCssPixels:function(){for(var b=Math,a=[window.innerWidth,window.document.documentElement.clientWidth,window.document.documentElement.offsetWidth,window.document.body.clientWidth],e=0,c,f=window.screen.width;e<a.length;e++)isNaN(a[e])&&(a.splice(e,1),e--);a.length&&(c=b.max.apply(b,a),isNaN(f)||(c=b.min(f,c)));return c||f||0},inviewport:function(b){return!a.rightoffold(b)&&!a.leftofbegin(b)&&
!a.belowthefold(b)&&!a.abovethetop(b)},leftofbegin:function(b){return a.scrollPos()[1]>=a.offset(b,"left")+b.width},offset:function(b,a){b=b.getBoundingClientRect();switch(a){case "left":return b.left;case "top":return b.top;default:return 0}},orientationEvent:function(){return a.supportsOrientationChange()?"orientationchange":"resize"},removeClass:function(b,a){var e="",c,f=b.className.split(" ");for(c=0;c<f.length;c++)f[c]!==a&&(e+=f[c]+" ");b.className=e},removeEvent:function(b,a,e){a.removeEventListener?
a.removeEventListener(b,e,!1):a.detachEvent?a.detachEvent("on"+b,e):a.splice(b,1)},rightoffold:function(b){return(window.innerWidth?window.innerWidth:Math.max(document.documentElement.clientWidth,document.body.clientWidth))+a.scrollPos()[1]<=a.offset(b,"left")},scrollPos:function(){return[void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||
document.body).scrollLeft]},setBreakpoint:function(b,d){if("hide"==d)b.className+=" srcbox-hidden","img"!=b.nodeName.toLowerCase()&&(b.style.backgroundImage="",b.style.backgroundRepeat="");else{0<=b.className.indexOf("srcbox-hidden")&&(b.className=b.className.replace(/(?:^|\s)srcbox-hidden(?!\S)/g,""));var e=b.getAttribute("data-breakpoint"),c=b.getAttribute("data-img");if(!e||!c)throw Error('srcBox.js [function setBreakpoint]: The provided elements are missing a data-breakpoint or data-img attribute: <img data-breakpoint="/path/to/folder/{breakpoint}" data-img="some-img.jpg" />');
e=(e+c).replace("{folder}",d);a.setSrc(b,e)}},setImage:function(b,d){var e=d.parentOffset?b.parentNode.offsetWidth:a.getViewportWidthInCssPixels(),e=a.getBreakpoint(d.breakpoints,e).folder;a.setBreakpoint(b,e)},setImages:function(b,d){viewPortWidth=a.getViewportWidthInCssPixels();breakpoint=a.getBreakpoint(h.settings[d].breakpoints,viewPortWidth);breakpointVal=breakpoint.maxWidth||breakpoint.minWidth;a.currentBreakpoint!=breakpointVal&&(d==a.selector[Object.size(a.selector)-1]&&(a.currentBreakpoint=
breakpointVal),a.forEach(b,function(e,c){a.setImage(b[c],h.settings[d])}),a.addEvent("scroll",window,a.setLazySrc))},setLazySrc:function(){for(var b=a.lazyElems.length;b--;)a.inviewport(a.lazyElems[b])&&(a.lazyElems[b].src=a.lazyElems[b].getAttribute("data-lag-src"),a.lazyElems[b].removeAttribute("height"),a.lazyElems.splice(b,1));a.lazyElems.length||a.removeEvent("scroll",window,a.setLazySrc)},setSrc:function(b,d){/(^|\s)lag(\s|$)/.test(b.className)?(b.setAttribute("data-lag-src",d),a.lazyElems.push(b)):
"img"===b.nodeName.toLowerCase()?(b.src=d,b.removeAttribute("height")):(b.style.backgroundImage="url("+d+")",b.style.backgroundRepeat="no-repeat")},supportsOrientationChange:function(){return"ontouchstart"in window}},h={settings:[],init:function(b,d){a.currentBreakpoint=0;if(document.all&&!document.addEventListener){var e=Array.prototype.slice;Array.prototype.slice=function(){if(this instanceof Array)return e.apply(this,arguments);for(var a=[],b=2<=arguments.length?arguments[1]:this.length,c=1<=arguments.length?
arguments[0]:0;c<b;c++)a.push(this[c]);return a}}var c=Array.prototype.slice.call(document.querySelectorAll(b)),f={breakpoints:[{folder:"480",maxWidth:480},{folder:"640",minWidth:481,maxWidth:767},{folder:"900",minWidth:768,maxWidth:900},{folder:"1170",minWidth:992},{folder:"900",minWidth:748,maxWidth:1024},{folder:"640",maxWidth:320,minDevicePixelRatio:2},{folder:"900",minWidth:320,maxWidth:667,minDevicePixelRatio:2},{folder:"2048",minWidth:414,maxWidth:736,minDevicePixelRatio:3},{folder:"2048",
minWidth:748,maxWidth:1024,minDevicePixelRatio:2}],parentOffset:!0},f="object"===typeof d&&"breakpoints"in d?"extend"in d&&!0===d.extend?a.extend(f,d):d:a.extend(f,d),g,k=function(){g--;if(!g)h.settings[b].onComplete()};h.settings[b]=f;a.selector[Object.size(a.selector)]=b;a.mergedElements[b]=c;a.setImages(c,b);a.setLazySrc();a.addEvent("scroll",window,a.setLazySrc);a.addEvent(a.orientationEvent(),window,a.debounce(function(){a.forEach(a.selector,function(b,c){a.setImages(a.mergedElements[a.selector[c]],
a.selector[c])})},250));"onComplete"in h.settings[b]&&(g=c.length)&&a.forEach(c,function(e,d){a.setImage(c[d],h.settings[b]);if(/[ws]*(lag)+[ws]*/.test(c[d].className)){if(g--,!g)h.settings[b].onComplete()}else if(c[d].onload=k,"complete"==c[d].readyState)c[d].onload();else if(c[d].readyState)c[d].src=c[d].src;else if(c[d].complete)c[d].onload();else if(void 0===c[d].complete){var f=c[d].src;c[d].src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";c[d].src=f}})},reset:function(b){a.currentBreakpoint=
0;var d=a.mergedElements[b];a.forEach(a.mergedElements[b],function(d,c){a.removeClass(a.mergedElements[b][c],b.substring(1))});h.init(b,h.settings[b]);a.forEach(d,function(a,c){d[c].className+=b.substring(1)})}};return h});