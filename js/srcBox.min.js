;(function(m,a){"function"===typeof define&&define.amd?define(a):"object"===typeof exports?module.exports=a:m.srcBox=a(m)})(this,function(m){var a={newItems:[],devicePixelRatio:function(){return"devicePixelRatio"in window?window.devicePixelRatio:1},lazyElems:[],breakpoint:0,currentBreakpoint:0,breakpointVal:0,viewPortWidth:0,forEach:function(b,a,d){if("[object Object]"===Object.prototype.toString.call(b))for(var e in b)Object.prototype.hasOwnProperty.call(b,e)&&a.call(d,b[e],e,b);else{e=0;for(var f=
b.length;e<f;e++)a.call(d,b[e],e,b)}},extend:function(b,c){var d={};a.forEach(b,function(a,c){d[c]=b[c]});a.forEach(c,function(b,a){d[a]=c[a]});return d},getViewportWidthInCssPixels:function(){for(var b=Math,a=[window.innerWidth,window.document.documentElement.clientWidth,window.document.documentElement.offsetWidth,window.document.body.clientWidth],d=0,e,f=window.screen.width;d<a.length;d++)isNaN(a[d])&&(a.splice(d,1),d--);a.length&&(e=b.max.apply(b,a),isNaN(f)||(e=b.min(f,e)));return e||f||0},getBreakpoint:function(b,
c){for(var d=c,e=0,f={},g,h,l,k;g=b[e];){k=g.minWidth;h=g.maxWidth;l="minDevicePixelRatio"in g?g.minDevicePixelRatio:0;if(0<c){if(k&&h&&c>=k&&c<=h||k&&!h&&c>=k||h&&!k&&c<=h)if(!l||l&&a.devicePixelRatio()>=l)f=g}else if(0>=d||k<d||h<d)d=k||h||d,f=g;e++}return f},setBreakpoint:function(b,c){var d=b.getAttribute("data-breakpoint"),e=b.getAttribute("data-img");if(!d||!e)throw Error('srcBox.js [function setBreakpoint]: The provided elements are missing a data-breakpoint or data-img attribute: <img data-breakpoint="/path/to/folder/{breakpoint}" data-img="some-img.jpg" />');
d=d.replace("{folder}",c)+b.getAttribute("data-img");/(^|\s)lag(\s|$)/.test(b.className)?(b.setAttribute("data-lag-src",d),a.lazyElems.push(b)):(b.src=d,b.removeAttribute("height"))},addEvent:function(a,c,d){c.addEventListener?c.addEventListener(a,d,!1):c.attachEvent?c.attachEvent("on"+a,d):c[a]=d},removeEvent:function(a,c,d){c.removeEventListener?c.removeEventListener(a,d,!1):c.detachEvent?c.detachEvent("on"+a,d):c.splice(a,1)},scrollPos:function(){return[void 0!==window.pageYOffset?window.pageYOffset:
(document.documentElement||document.body.parentNode||document.body).scrollTop,void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft]},offset:function(a,c){a=a.getBoundingClientRect();switch(c){case "left":return a.left;case "top":return a.top;default:return 0}},belowthefold:function(b){return(window.innerHeight?window.innerHeight:Math.max(document.documentElement.clientHeight,document.body.clientHeight))+a.scrollPos()[0]<=a.offset(b,
"top")},rightoffold:function(b){return(window.innerWidth?window.innerWidth:Math.max(document.documentElement.clientWidth,document.body.clientWidth))+a.scrollPos()[1]<=a.offset(b,"left")},abovethetop:function(b){return a.scrollPos()[0]>=a.offset(b,"top")+b.height},leftofbegin:function(b){return a.scrollPos()[1]>=a.offset(b,"left")+b.width},inviewport:function(b){return!a.rightoffold(b)&&!a.leftofbegin(b)&&!a.belowthefold(b)&&!a.abovethetop(b)},setLazySrc:function(){for(var b=a.lazyElems.length;b--;)a.inviewport(a.lazyElems[b])&&
(a.lazyElems[b].src=a.lazyElems[b].getAttribute("data-lag-src"),a.lazyElems[b].removeAttribute("height"),a.lazyElems.splice(b,1));a.lazyElems.length||a.removeEvent("scroll",window,a.setLazySrc)},debounce:function(a,c,d){var e;return function(){var f=this,g=arguments,h=d&&!e;clearTimeout(e);e=setTimeout(function(){e=null;d||a.apply(f,g)},c);h&&a.apply(f,g)}},setImage:function(b,c){if("IMG"===b.nodeName){var d=a.getBreakpoint(c.breakpoints,b.parentNode.offsetWidth);a.setBreakpoint(b,"minDevicePixelRatio"in
d?d.maxWidth:d.folder)}},setImages:function(b,c){viewPortWidth=a.getViewportWidthInCssPixels();breakpoint=a.getBreakpoint(c.breakpoints,viewPortWidth);breakpointVal="minDevicePixelRatio"in breakpoint?breakpoint.maxWidth:breakpoint.folder-0;a.currentBreakpoint!==breakpointVal&&(a.currentBreakpoint=breakpointVal,a.forEach(b,function(d,e){a.setImage(b[e],c)}),a.addEvent("scroll",window,a.setLazySrc))},waitForNew:function(b){b.cancelBubble=!0;b.stopPropagation&&b.stopPropagation();var c;"IMG"===b.target.nodeName?
(c=b.target,a.newItems.push(c)):b.target.querySelector&&(c=b.target.querySelectorAll("img"),a.forEach(c,function(b,e){a.newItems.push(c[e])}))},supportsOrientationChange:function(){return"ontouchstart"in window},orientationEvent:function(){return supportsOrientationChange?"orientationchange":"resize"}};return function(b,c){var d=document.querySelectorAll(b),e={breakpoints:[{folder:"480",maxWidth:480},{folder:"640",minWidth:481,maxWidth:767},{folder:"900",minWidth:768,maxWidth:900},{folder:"1170",
minWidth:992},{folder:"900",minWidth:748,maxWidth:1024},{folder:"640",maxWidth:320,minDevicePixelRatio:2},{folder:"900",minWidth:320,maxWidth:667,minDevicePixelRatio:2},{folder:"2048",minWidth:414,maxWidth:736,minDevicePixelRatio:3},{folder:"2048",minWidth:748,maxWidth:1024,minDevicePixelRatio:2}]},f="object"===typeof c&&"breakpoints"in c?"extend"in c&&!0===c.extend?a.extend(e,c):c:e,g,h=function n(){g--;if(!g)f.onNewNode();a.removeEvent("load",this,n)},l=function p(){g--;if(!g)f.onComplete();a.removeEvent("load",
this,p)};a.setImages(d,f);a.setLazySrc();a.addEvent("scroll",window,a.setLazySrc);a.addEvent(a.orientationEvent,window,a.debounce(function(){a.setImages(d,f)},250));"onNewNode"in f&&a.addEvent("load",window,function(){a.addEvent("DOMNodeInserted",document,a.debounce(function(){if(g=a.newItems.length)a.forEach(a.newItems,function(b,c){/[ws]*(srcbox)+[ws]*/.test(a.newItems[c].className)&&(a.setImage(a.newItems[c],f),a.addEvent("load",a.newItems[c],h))}),a.newItems.splice(0,a.newItems.length)},250));
a.addEvent("DOMNodeInserted",document,a.waitForNew)});"onComplete"in f&&(g=d.length)&&a.forEach(d,function(b,c){a.setImage(d[c],f);if(/[ws]*(lag)+[ws]*/.test(d[c].className)){if(g--,!g)f.onComplete()}else a.addEvent("load",d[c],l)})}});