(function(m,b){"function"===typeof define&&define.amd?define(b):"object"===typeof exports?module.exports=b:m.srcBox=b(m)})(this,function(m){var b={mergedElements:[],selector:[],devicePixelRatio:function(){return"devicePixelRatio"in window?window.devicePixelRatio:1},lazyElems:[],breakpoint:0,currentBreakpoint:0,breakpointVal:0,viewPortWidth:0,forEach:function(a,b,e){if("[object Object]"===Object.prototype.toString.call(a))for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.call(e,a[c],c,a);
else{c=0;for(var f=a.length;c<f;c++)b.call(e,a[c],c,a)}},extend:function(a,d){var e={};b.forEach(a,function(b,d){e[d]=a[d]});b.forEach(d,function(a,b){e[b]=d[b]});return e},getViewportWidthInCssPixels:function(){for(var a=Math,b=[window.innerWidth,window.document.documentElement.clientWidth,window.document.documentElement.offsetWidth,window.document.body.clientWidth],e=0,c,f=window.screen.width;e<b.length;e++)isNaN(b[e])&&(b.splice(e,1),e--);b.length&&(c=a.max.apply(a,b),isNaN(f)||(c=a.min(f,c)));
return c||f||0},getBreakpoint:function(a,d){for(var e=d,c=0,f={},g,k,h,l,n;g=a[c];){l=g.minWidth;k=g.maxWidth;h="minDevicePixelRatio"in g?g.minDevicePixelRatio:0;n="hide"in g;if(0<d){if(l&&k&&d>=l&&d<=k||l&&!k&&d>=l||k&&!l&&d<=k)if(!h||h&&b.devicePixelRatio()>=h)f=g,k&&n&&(f.folder="hide")}else if(0>=e||l<e||k<e)e=l||k||e,f=g;c++}return f},setBreakpoint:function(a,d){if("hide"==d)a.className+=" srcbox-hidden","img"!=a.nodeName.toLowerCase()&&(a.style.backgroundImage="",a.style.backgroundPosition=
"",a.style.backgroundRepeat="");else{0<=a.className.indexOf("srcbox-hidden")&&(a.className=a.className.replace(/(?:^|\s)srcbox-hidden(?!\S)/,""));var e=a.getAttribute("data-breakpoint"),c=a.getAttribute("data-img");if(!e||!c)throw Error('srcBox.js [function setBreakpoint]: The provided elements are missing a data-breakpoint or data-img attribute: <img data-breakpoint="/path/to/folder/{breakpoint}" data-img="some-img.jpg" />');e=(e+c).replace("{folder}",d);b.setSrc(a,e)}},setSrc:function(a,d){/(^|\s)lag(\s|$)/.test(a.className)?
(a.setAttribute("data-lag-src",d),b.lazyElems.push(a)):"img"===a.nodeName.toLowerCase()?(a.src=d,a.removeAttribute("height")):(a.style.backgroundImage="url("+d+")",a.style.backgroundPosition="center center",a.style.backgroundRepeat="no-repeat")},addEvent:function(a,b,e){b.addEventListener?b.addEventListener(a,e,!1):b.attachEvent?b.attachEvent("on"+a,e):b[a]=e},removeEvent:function(a,b,e){b.removeEventListener?b.removeEventListener(a,e,!1):b.detachEvent?b.detachEvent("on"+a,e):b.splice(a,1)},removeClass:function(a,
b){var e="",c,f=a.className.split(" ");for(c=0;c<f.length;c++)f[c]!==b&&(e+=f[c]+" ");a.className=e},scrollPos:function(){return[void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop,void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft]},offset:function(a,b){a=a.getBoundingClientRect();switch(b){case "left":return a.left;case "top":return a.top;default:return 0}},
belowthefold:function(a){return(window.innerHeight?window.innerHeight:Math.max(document.documentElement.clientHeight,document.body.clientHeight))+b.scrollPos()[0]<=b.offset(a,"top")},rightoffold:function(a){return(window.innerWidth?window.innerWidth:Math.max(document.documentElement.clientWidth,document.body.clientWidth))+b.scrollPos()[1]<=b.offset(a,"left")},abovethetop:function(a){return b.scrollPos()[0]>=b.offset(a,"top")+a.height},leftofbegin:function(a){return b.scrollPos()[1]>=b.offset(a,"left")+
a.width},inviewport:function(a){return!b.rightoffold(a)&&!b.leftofbegin(a)&&!b.belowthefold(a)&&!b.abovethetop(a)},setLazySrc:function(){for(var a=b.lazyElems.length;a--;)b.inviewport(b.lazyElems[a])&&(b.lazyElems[a].src=b.lazyElems[a].getAttribute("data-lag-src"),b.lazyElems[a].removeAttribute("height"),b.lazyElems.splice(a,1));b.lazyElems.length||b.removeEvent("scroll",window,b.setLazySrc)},debounce:function(a,b,e){var c;return function(){var f=this,g=arguments,h=e&&!c;clearTimeout(c);c=setTimeout(function(){c=
null;e||a.apply(f,g)},b);h&&a.apply(f,g)}},setImage:function(a,d){var e=d.parentOffset?a.parentNode.offsetWidth:b.getViewportWidthInCssPixels(),e=b.getBreakpoint(d.breakpoints,e).folder;b.setBreakpoint(a,e)},setImages:function(a,d){viewPortWidth=b.getViewportWidthInCssPixels();breakpoint=b.getBreakpoint(h.settings[d].breakpoints,viewPortWidth);breakpointVal=breakpoint.maxWidth||breakpoint.minWidth;b.currentBreakpoint!=breakpointVal&&(d==b.selector.keys()[b.selector.length-1]&&(b.currentBreakpoint=
breakpointVal),b.forEach(a,function(e,c){b.setImage(a[c],h.settings[d])}),b.addEvent("scroll",window,b.setLazySrc))},supportsOrientationChange:function(){return"ontouchstart"in window},orientationEvent:function(){return b.supportsOrientationChange()?"orientationchange":"resize"}},h={settings:[],init:function(a,d){b.currentBreakpoint=0;if(document.all&&!document.addEventListener){var e=Array.prototype.slice;Array.prototype.slice=function(){if(this instanceof Array)return e.apply(this,arguments);for(var a=
[],b=2<=arguments.length?arguments[1]:this.length,c=1<=arguments.length?arguments[0]:0;c<b;c++)a.push(this[c]);return a}}var c=Array.prototype.slice.call(document.querySelectorAll(a)),f={breakpoints:[{folder:"480",maxWidth:480},{folder:"640",minWidth:481,maxWidth:767},{folder:"900",minWidth:768,maxWidth:900},{folder:"1170",minWidth:992},{folder:"900",minWidth:748,maxWidth:1024},{folder:"640",maxWidth:320,minDevicePixelRatio:2},{folder:"900",minWidth:320,maxWidth:667,minDevicePixelRatio:2},{folder:"2048",
minWidth:414,maxWidth:736,minDevicePixelRatio:3},{folder:"2048",minWidth:748,maxWidth:1024,minDevicePixelRatio:2}],parentOffset:!0},f="object"===typeof d&&"breakpoints"in d?"extend"in d&&!0===d.extend?b.extend(f,d):d:b.extend(f,d),g,k=function(){g--;if(!g)h.settings[a].onComplete()};h.settings[a]=f;b.selector.push(a);b.mergedElements[a]=c;b.setImages(c,a);b.setLazySrc();b.addEvent("scroll",window,b.setLazySrc);b.addEvent(b.orientationEvent(),window,b.debounce(function(){b.forEach(b.selector,function(a,
c){b.setImages(b.mergedElements[b.selector[c]],b.selector[c])})},250));"onComplete"in h.settings[a]&&(g=c.length)&&b.forEach(c,function(e,d){b.setImage(c[d],h.settings[a]);if(/[ws]*(lag)+[ws]*/.test(c[d].className)){if(g--,!g)h.settings[a].onComplete()}else if(c[d].onload=k,"complete"==c[d].readyState)c[d].onload();else if(c[d].readyState)c[d].src=c[d].src;else if(c[d].complete)c[d].onload();else if(void 0===c[d].complete){var f=c[d].src;c[d].src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";
c[d].src=f}})},reset:function(a){b.currentBreakpoint=0;var d=b.mergedElements[a];b.forEach(b.mergedElements[a],function(d,c){b.removeClass(b.mergedElements[a][c],a.substring(1))});h.init(a,h.settings[a]);b.forEach(d,function(b,c){d[c].className+=a.substring(1)})}};return h});